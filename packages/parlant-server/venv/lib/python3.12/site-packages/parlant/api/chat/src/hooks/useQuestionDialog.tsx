import { useCallback } from 'react'
import { useAtom } from 'jotai'
import { Button } from '@/components/ui/button'
import { dialogAtom } from '@/store'

interface Action {
  text: string
  onClick: () => void
  isMainAction?: boolean
}

export const useQuestionDialog = () => {
  const [dialog] = useAtom(dialogAtom)

  const openQuestionDialog = useCallback(
    (title: string, question: string, actions: Action[]) => {
      const Content = () => (
        <div className='ms-[30px] me-[20px] flex h-full flex-col justify-between'>
          <p className='mt-[10px]'>{question}</p>
          <div className='flex h-[80px] items-center justify-end'>
            <Button
              data-testid='cancel'
              onClick={dialog.closeDialog}
              className='me-[10px] h-[46px] w-[96px] rounded-[6px] bg-[#F2F0FC] px-[24px] py-[12px] font-normal text-[16px] text-black hover:bg-[#EBE9F5]'
            >
              Cancel
            </Button>
            {actions.map((action) => {
              if (action.isMainAction)
                return (
                  <Button
                    key={action.text}
                    onClick={action.onClick}
                    className='h-[46px] w-[161px] rounded-[6px] bg-green-main px-[29.5px] py-[10px] font-medium text-[15px] hover:bg-[#005C3F]'
                  >
                    {action.text}
                  </Button>
                )
              return (
                <Button
                  key={action.text}
                  onClick={action.onClick}
                  className='me-[10px] h-[46px] w-[96px] rounded-[6px] bg-[#F2F0FC] px-[24px] py-[12px] font-normal text-[16px] text-black hover:bg-[#EBE9F5]'
                >
                  {action.text}
                </Button>
              )
            })}
          </div>
        </div>
      )
      return dialog.openDialog(title, <Content />, { height: '230px', width: '480px' })
    },
    [dialog]
  )

  return { openQuestionDialog, closeQuestionDialog: dialog.closeDialog }
}
